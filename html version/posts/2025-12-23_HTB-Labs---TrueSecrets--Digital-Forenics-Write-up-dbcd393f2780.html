<!DOCTYPE html><html><head><meta http-equiv="Content-Type" content="text/html; charset=utf-8"><title>HTB Labs : TrueSecrets |Digital Forenics Write-up</title><style>
      * {
        font-family: Georgia, Cambria, "Times New Roman", Times, serif;
      }
      html, body {
        margin: 0;
        padding: 0;
      }
      h1 {
        font-size: 50px;
        margin-bottom: 17px;
        color: #333;
      }
      h2 {
        font-size: 24px;
        line-height: 1.6;
        margin: 30px 0 0 0;
        margin-bottom: 18px;
        margin-top: 33px;
        color: #333;
      }
      h3 {
        font-size: 30px;
        margin: 10px 0 20px 0;
        color: #333;
      }
      header {
        width: 640px;
        margin: auto;
      }
      section {
        width: 640px;
        margin: auto;
      }
      section p {
        margin-bottom: 27px;
        font-size: 20px;
        line-height: 1.6;
        color: #333;
      }
      section img {
        max-width: 640px;
      }
      footer {
        padding: 0 20px;
        margin: 50px 0;
        text-align: center;
        font-size: 12px;
      }
      .aspectRatioPlaceholder {
        max-width: auto !important;
        max-height: auto !important;
      }
      .aspectRatioPlaceholder-fill {
        padding-bottom: 0 !important;
      }
      header,
      section[data-field=subtitle],
      section[data-field=description] {
        display: none;
      }
      </style></head><body><article class="h-entry">
<header>
<h1 class="p-name">HTB Labs : TrueSecrets |Digital Forenics Write-up</h1>
</header>
<section data-field="subtitle" class="p-summary">
Challenge Scenario
</section>
<section data-field="body" class="e-content">
<section name="37e1" class="section section--body section--first section--last"><div class="section-divider"><hr class="section-divider"></div><div class="section-content"><div class="section-inner sectionLayout--insetColumn"><h3 name="3335" id="3335" class="graf graf--h3 graf--leading graf--title">HTB Labs : <strong class="markup--strong markup--h3-strong">TrueSecrets |Digital Forenics Write-up</strong></h3><figure name="7bab" id="7bab" class="graf graf--figure graf-after--h3"><img class="graf-image" data-image-id="1*sSeTqK2Jsa21EiqnDBIYTg.png" data-width="1144" data-height="524" data-is-featured="true" src="https://cdn-images-1.medium.com/max/800/1*sSeTqK2Jsa21EiqnDBIYTg.png"></figure><h3 name="019f" id="019f" class="graf graf--h3 graf-after--figure">Challenge Scenario</h3><p name="7426" id="7426" class="graf graf--p graf-after--h3">Our cybercrime unit has been investigating a well-known APT group for several months. The group has been responsible for several high-profile attacks on corporate organizations. However, what is interesting about that case, is that they have developed a custom command &amp; control server of their own. Fortunately, our unit was able to raid the home of the leader of the APT group and take a memory capture of his computer while it was still powered on. Analyze the capture to try to find the source code of the server.</p><h3 name="fe62" id="fe62" class="graf graf--h3 graf-after--p">Challenge Information</h3><ul class="postList"><li name="df81" id="df81" class="graf graf--li graf-after--h3"><strong class="markup--strong markup--li-strong">Category:</strong> Memory Forensics</li><li name="baa2" id="baa2" class="graf graf--li graf-after--li"><strong class="markup--strong markup--li-strong">Memory Image:</strong> <code class="markup--code markup--li-code">TrueSecrets.raw</code></li></ul><p name="0dad" id="0dad" class="graf graf--p graf-after--li"><strong class="markup--strong markup--p-strong">Tools Used:</strong></p><ul class="postList"><li name="bcf5" id="bcf5" class="graf graf--li graf-after--p">Volatility Workbench v3.0 (GUI)</li><li name="964d" id="964d" class="graf graf--li graf-after--li">Volatility CLI v2.1</li></ul><h3 name="812e" id="812e" class="graf graf--h3 graf-after--li">What Is Volatility?</h3><p name="0909" id="0909" class="graf graf--p graf-after--h3">Volatility is an <strong class="markup--strong markup--p-strong">open-source memory forensics framework</strong> used for <strong class="markup--strong markup--p-strong">incident response, malware analysis, and digital investigations</strong>. It allows investigators to extract processes, files, credentials, encryption keys, and other forensic artifacts directly from volatile memory (RAM).</p><h3 name="bcd6" id="bcd6" class="graf graf--h3 graf-after--p">Initial Analysis: Process Enumeration</h3><p name="99ec" id="99ec" class="graf graf--p graf-after--h3">After refreshing the process list, an interesting process stood out:</p><pre data-code-block-mode="1" spellcheck="false" data-code-block-lang="yaml" name="da52" id="da52" class="graf graf--pre graf-after--p graf--preV2"><span class="pre--content"><span class="hljs-number">2128  </span><span class="hljs-number">1464  </span><span class="hljs-string">TrueCrypt.exe</span>  <span class="hljs-number">0x91892030</span>  <span class="hljs-number">4</span>  <span class="hljs-number">262</span>  <span class="hljs-number">1</span>  <span class="hljs-literal">False</span>  <br /><span class="hljs-number">2022-12-14 21:08:31 </span><span class="hljs-string">UTC</span>  <span class="hljs-string">N/A</span>  <span class="hljs-string">Disabled</span></span></pre><p name="ba96" id="ba96" class="graf graf--p graf-after--pre">The presence of <strong class="markup--strong markup--p-strong">TrueCrypt</strong> strongly suggested that <strong class="markup--strong markup--p-strong">encrypted containers</strong> might be in use, possibly hiding sensitive files such as source code.</p><figure name="14bb" id="14bb" class="graf graf--figure graf-after--p"><img class="graf-image" data-image-id="1*AvGuYNPXtHZCGpooG0Vtdg.png" data-width="1365" data-height="720" src="https://cdn-images-1.medium.com/max/800/1*AvGuYNPXtHZCGpooG0Vtdg.png"></figure><h3 name="cf34" id="cf34" class="graf graf--h3 graf-after--figure">Extracting the TrueCrypt Password from Memory</h3><p name="005f" id="005f" class="graf graf--p graf-after--h3">Using Volatility’s TrueCrypt scanning capabilities, a password was successfully recovered from memory:</p><pre data-code-block-mode="1" spellcheck="false" data-code-block-lang="typescript" name="cc11" id="cc11" class="graf graf--pre graf-after--p graf--preV2"><span class="pre--content"><span class="hljs-number">0x89ebf064</span>  <span class="hljs-number">28</span>  X2Hk2XbEJqWYsh8VdbSYg6WpG9g7</span></pre><p name="def2" id="def2" class="graf graf--p graf-after--pre"><strong class="markup--strong markup--p-strong">Recovered Password:</strong></p><pre data-code-block-mode="1" spellcheck="false" data-code-block-lang="typescript" name="bc84" id="bc84" class="graf graf--pre graf-after--p graf--preV2"><span class="pre--content">X2Hk2XbEJqWYsh8VdbSYg6WpG9g7</span></pre><h3 name="0cfb" id="0cfb" class="graf graf--h3 graf-after--pre">Why TrueCrypt Matters</h3><p name="c5e4" id="c5e4" class="graf graf--p graf-after--h3">TrueCrypt is a disk encryption software that allows users to create <strong class="markup--strong markup--p-strong">encrypted container files</strong> that can be mounted as virtual drives. These containers are protected by a <strong class="markup--strong markup--p-strong">passphrase</strong>, and if the system is live, that passphrase may exist in memory.</p><p name="7d93" id="7d93" class="graf graf--p graf-after--p">This strongly indicated that the recovered password could be used later to access protected data.</p><h3 name="70f5" id="70f5" class="graf graf--h3 graf-after--p">File Discovery Using Volatility CLI</h3><p name="935f" id="935f" class="graf graf--p graf-after--h3">Before scanning for files, the correct memory profile had to be identified.</p><h3 name="9b62" id="9b62" class="graf graf--h3 graf-after--p">Identifying the Profile</h3><figure name="dc87" id="dc87" class="graf graf--figure graf-after--h3"><img class="graf-image" data-image-id="1*Ge_G-F4wchcqUSEM9yJluQ.png" data-width="1096" data-height="309" src="https://cdn-images-1.medium.com/max/800/1*Ge_G-F4wchcqUSEM9yJluQ.png"></figure><pre data-code-block-mode="1" spellcheck="false" data-code-block-lang="typescript" name="6479" id="6479" class="graf graf--pre graf-after--figure graf--preV2"><span class="pre--content">volatility.<span class="hljs-property">exe</span> -f <span class="hljs-title class_">TrueSecrets</span>.<span class="hljs-property">raw</span> imageinfo</span></pre><p name="aa26" id="aa26" class="graf graf--p graf-after--pre">From the suggested profiles, the first one was selected:</p><pre data-code-block-mode="1" spellcheck="false" data-code-block-lang="typescript" name="1648" id="1648" class="graf graf--pre graf-after--p graf--preV2"><span class="pre--content"><span class="hljs-title class_">Win7SP1</span>x86_23418</span></pre><p name="ac1d" id="ac1d" class="graf graf--p graf-after--pre">All further commands were executed using:</p><pre data-code-block-mode="1" spellcheck="false" data-code-block-lang="ini" name="8ced" id="8ced" class="graf graf--pre graf-after--p graf--preV2"><span class="pre--content"><span class="hljs-attr">--profile</span>=Win7SP1x<span class="hljs-number">86_23418</span></span></pre><h3 name="d443" id="d443" class="graf graf--h3 graf-after--pre">Scanning for Files</h3><p name="e773" id="e773" class="graf graf--p graf-after--h3">To enumerate files present in memory:</p><pre data-code-block-mode="1" spellcheck="false" data-code-block-lang="lua" name="3846" id="3846" class="graf graf--pre graf-after--p graf--preV2"><span class="pre--content">volatility.exe -f TrueSecrets.raw <span class="hljs-comment">--profile=Win7SP1x86_23418 filescan</span></span></pre><figure name="5b42" id="5b42" class="graf graf--figure graf-after--pre"><img class="graf-image" data-image-id="1*2mX9iAhCmma31SVMPWC4tg.png" data-width="1115" data-height="302" src="https://cdn-images-1.medium.com/max/800/1*2mX9iAhCmma31SVMPWC4tg.png"></figure><p name="dc2e" id="dc2e" class="graf graf--p graf-after--figure">To narrow down results, Windows <code class="markup--code markup--p-code">findstr</code> was used (similar to <code class="markup--code markup--p-code">grep</code> in Linux):</p><pre data-code-block-mode="1" spellcheck="false" data-code-block-lang="bash" name="8ee3" id="8ee3" class="graf graf--pre graf-after--p graf--preV2"><span class="pre--content">volatility.exe -f TrueSecrets.raw --profile=Win7SP1x86_23418 filescan | findstr <span class="hljs-string">&quot;.zip&quot;</span></span></pre><figure name="dc7b" id="dc7b" class="graf graf--figure graf-after--pre"><img class="graf-image" data-image-id="1*o8fyZyvYlJFcdNqJ8pUmjw.png" data-width="1365" data-height="250" src="https://cdn-images-1.medium.com/max/800/1*o8fyZyvYlJFcdNqJ8pUmjw.png"></figure><h3 name="3a07" id="3a07" class="graf graf--h3 graf-after--figure">Interesting Discovery</h3><p name="f101" id="f101" class="graf graf--p graf-after--h3">After extensive analysis, the following file was found:</p><pre data-code-block-mode="1" spellcheck="false" data-code-block-lang="css" name="85ca" id="85ca" class="graf graf--pre graf-after--p graf--preV2"><span class="pre--content"><span class="hljs-number">0</span>x000000000bbf6158  <span class="hljs-number">3</span>  <span class="hljs-number">1</span>  R<span class="hljs-attr">--r--</span>  <br />\Device\HarddiskVolume1\Users\IEUser\Documents\backup_development<span class="hljs-selector-class">.zip</span></span></pre><h3 name="0d0b" id="0d0b" class="graf graf--h3 graf-after--pre">Dumping the ZIP File from Memory</h3><p name="9167" id="9167" class="graf graf--p graf-after--h3">To extract the file from memory, the <code class="markup--code markup--p-code">dumpfiles</code> plugin was used:</p><pre data-code-block-mode="1" spellcheck="false" data-code-block-lang="diff" name="5456" id="5456" class="graf graf--pre graf-after--p graf--preV2"><span class="pre--content">volatility.exe -f TrueSecrets.raw --profile=Win7SP1x86_23418 dumpfiles <br /><span class="hljs-deletion">-Q 0x000000000bbf6158 </span><br /><span class="hljs-deletion">--dump-dir C:\Users\loki\Downloads\VolatilityWorkbench-v2.1\</span></span></pre><p name="39d7" id="39d7" class="graf graf--p graf-after--pre"><strong class="markup--strong markup--p-strong">Explanation:</strong></p><ul class="postList"><li name="a4b4" id="a4b4" class="graf graf--li graf-after--p"><code class="markup--code markup--li-code">-Q</code> specifies the offset of the file</li><li name="b599" id="b599" class="graf graf--li graf-after--li"><code class="markup--code markup--li-code">--dump-dir</code> specifies where the extracted files will be saved</li></ul><figure name="4971" id="4971" class="graf graf--figure graf-after--li"><img class="graf-image" data-image-id="1*2gZ2W_Olhloc__N3aeEyLQ.png" data-width="1365" data-height="206" src="https://cdn-images-1.medium.com/max/800/1*2gZ2W_Olhloc__N3aeEyLQ.png"></figure><h3 name="4486" id="4486" class="graf graf--h3 graf-after--figure">Reconstructing the ZIP Archive</h3><p name="851c" id="851c" class="graf graf--p graf-after--h3">The dumped output resulted in multiple <code class="markup--code markup--p-code">.dat</code> files. These were reconstructed into a single ZIP file:</p><pre data-code-block-mode="1" spellcheck="false" data-code-block-lang="bash" name="6a37" id="6a37" class="graf graf--pre graf-after--p graf--preV2"><span class="pre--content">copy /b file1.dat + file2.dat backup_reconstructed.zip</span></pre><p name="5be2" id="5be2" class="graf graf--p graf-after--pre">After extraction, a <code class="markup--code markup--p-code">.tc</code> file was discovered.</p><figure name="25bf" id="25bf" class="graf graf--figure graf-after--p"><img class="graf-image" data-image-id="1*4JDi2fu7-KBjIh6RoHQkRA.png" data-width="750" data-height="203" src="https://cdn-images-1.medium.com/max/800/1*4JDi2fu7-KBjIh6RoHQkRA.png"></figure><figure name="8af7" id="8af7" class="graf graf--figure graf-after--figure"><img class="graf-image" data-image-id="1*JIs7EcVfPCQI8YzT8WqLaw.png" data-width="712" data-height="85" src="https://cdn-images-1.medium.com/max/800/1*JIs7EcVfPCQI8YzT8WqLaw.png"></figure><figure name="68c6" id="68c6" class="graf graf--figure graf-after--figure"><img class="graf-image" data-image-id="1*lrTOjEqJbl-j26PbbsLA7g.png" data-width="1219" data-height="355" src="https://cdn-images-1.medium.com/max/800/1*lrTOjEqJbl-j26PbbsLA7g.png"></figure><h3 name="4757" id="4757" class="graf graf--h3 graf-after--figure">Analyzing the TrueCrypt Container</h3><p name="34e9" id="34e9" class="graf graf--p graf-after--h3">The <code class="markup--code markup--p-code">.tc</code> file was identified as a <strong class="markup--strong markup--p-strong">TrueCrypt container</strong>.</p><p name="f22e" id="f22e" class="graf graf--p graf-after--p">To open it, either of the following tools can be used:</p><ul class="postList"><li name="8f51" id="8f51" class="graf graf--li graf-after--p">VeraCrypt</li><li name="4aef" id="4aef" class="graf graf--li graf-after--li">TrueCrypt (legacy)</li></ul><figure name="a47a" id="a47a" class="graf graf--figure graf-after--li"><img class="graf-image" data-image-id="1*W0_7JTCKW3lAglVIbjTGFg.png" data-width="929" data-height="543" src="https://cdn-images-1.medium.com/max/800/1*W0_7JTCKW3lAglVIbjTGFg.png"></figure><p name="2ff7" id="2ff7" class="graf graf--p graf-after--figure">The container was mounted using:</p><ul class="postList"><li name="bedd" id="bedd" class="graf graf--li graf-after--p">The recovered password:<br> <code class="markup--code markup--li-code">X2Hk2XbEJqWYsh8VdbSYg6WpG9g7</code></li></ul><figure name="61eb" id="61eb" class="graf graf--figure graf-after--li"><img class="graf-image" data-image-id="1*usV7mG1_ndCRmkt0F0ArUg.png" data-width="594" data-height="525" src="https://cdn-images-1.medium.com/max/800/1*usV7mG1_ndCRmkt0F0ArUg.png"></figure><p name="e07a" id="e07a" class="graf graf--p graf-after--figure">Once mounted, a file named <code class="markup--code markup--p-code"><strong class="markup--strong markup--p-strong">malware_agent</strong></code> was revealed.</p><figure name="6a64" id="6a64" class="graf graf--figure graf-after--p"><img class="graf-image" data-image-id="1*FQZgjjDLXVIJ4FbWsnwsKg.png" data-width="852" data-height="399" src="https://cdn-images-1.medium.com/max/800/1*FQZgjjDLXVIJ4FbWsnwsKg.png"></figure><h3 name="b745" id="b745" class="graf graf--h3 graf-after--figure">Decrypting the Malware Sessions</h3><p name="3db8" id="3db8" class="graf graf--p graf-after--h3">Inside the mounted drive, a <code class="markup--code markup--p-code">sessions</code> folder contained multiple encrypted <code class="markup--code markup--p-code">.ENC</code> files.</p><figure name="7c33" id="7c33" class="graf graf--figure graf-after--p"><img class="graf-image" data-image-id="1*pUK_Xhid6q4CPdvLOTh02g.png" data-width="785" data-height="414" src="https://cdn-images-1.medium.com/max/800/1*pUK_Xhid6q4CPdvLOTh02g.png"></figure><p name="4eaf" id="4eaf" class="graf graf--p graf-after--figure">An <strong class="markup--strong markup--p-strong"><em class="markup--em markup--p-em">AgentServer.cs </em></strong>C# file was found and opened for analysis. Inside it, the encryption parameters were revealed:</p><figure name="ce13" id="ce13" class="graf graf--figure graf-after--p"><img class="graf-image" data-image-id="1*lC2WdWmdsz62hnXhCkkoQw.png" data-width="696" data-height="356" src="https://cdn-images-1.medium.com/max/800/1*lC2WdWmdsz62hnXhCkkoQw.png"></figure><pre data-code-block-mode="1" spellcheck="false" data-code-block-lang="vbnet" name="bc24" id="bc24" class="graf graf--pre graf-after--figure graf--preV2"><span class="pre--content"><span class="hljs-type">string</span> <span class="hljs-keyword">key</span> = <span class="hljs-string">&quot;AKaPdSgV&quot;</span>;<br /><span class="hljs-type">string</span> iv  = <span class="hljs-string">&quot;QeThWmYq&quot;</span>;</span></pre><figure name="c571" id="c571" class="graf graf--figure graf-after--pre"><img class="graf-image" data-image-id="1*QpfCU2SQTxHmGjN6suMvHQ.png" data-width="1365" data-height="600" src="https://cdn-images-1.medium.com/max/800/1*QpfCU2SQTxHmGjN6suMvHQ.png"></figure><figure name="a6d0" id="a6d0" class="graf graf--figure graf-after--figure"><img class="graf-image" data-image-id="1*524rQwJ5gGqG0AGVlz-xRg.png" data-width="793" data-height="289" src="https://cdn-images-1.medium.com/max/800/1*524rQwJ5gGqG0AGVlz-xRg.png"></figure><p name="6c10" id="6c10" class="graf graf--p graf-after--figure"><strong class="markup--strong markup--p-strong">Encryption Scheme:</strong></p><pre data-code-block-mode="1" spellcheck="false" data-code-block-lang="ini" name="13fe" id="13fe" class="graf graf--pre graf-after--p graf--preV2"><span class="pre--content"><span class="hljs-attr">Key</span> = IV + Key</span></pre><p name="1530" id="1530" class="graf graf--p graf-after--pre">Using the key, we decrypted the encrypted session files line by line with a decryption tool.</p><p name="b07c" id="b07c" class="graf graf--p graf-after--p">tool:</p><p name="3e02" id="3e02" class="graf graf--p graf-after--p"><a href="https://anycript.com/crypto/des" data-href="https://anycript.com/crypto/des" class="markup--anchor markup--p-anchor" rel="nofollow noopener" target="_blank">https://anycript.com/crypto/des</a></p><h3 name="3701" id="3701" class="graf graf--h3 graf-after--p">Flag Recovery</h3><p name="6b5e" id="6b5e" class="graf graf--p graf-after--h3">After decrypting the files, the flag was found in the <strong class="markup--strong markup--p-strong">third decrypted file</strong>:</p><pre data-code-block-mode="1" spellcheck="false" data-code-block-lang="typescript" name="a6f6" id="a6f6" class="graf graf--pre graf-after--p graf--preV2"><span class="pre--content"><span class="hljs-variable constant_">HTB</span>{570r1ng_53cr37_1n_m3m0ry_15_n07_g00d}</span></pre><h3 name="677c" id="677c" class="graf graf--h3 graf-after--pre">References</h3><ul class="postList"><li name="8ab9" id="8ab9" class="graf graf--li graf-after--h3"><a href="https://www.varonis.com/blog/how-to-use-volatility" data-href="https://www.varonis.com/blog/how-to-use-volatility" class="markup--anchor markup--li-anchor" rel="noopener" target="_blank">https://www.varonis.com/blog/how-to-use-volatility</a></li><li name="a19f" id="a19f" class="graf graf--li graf-after--li graf--trailing"><a href="https://www.hackingarticles.in/memory-forensics-using-volatility-workbench/" data-href="https://www.hackingarticles.in/memory-forensics-using-volatility-workbench/" class="markup--anchor markup--li-anchor" rel="noopener" target="_blank">https://www.hackingarticles.in/memory-forensics-using-volatility-workbench/</a></li></ul></div></div></section>
</section>
<footer><p>By <a href="https://medium.com/@conan0s4" class="p-author h-card">Alexander Sapo</a> on <a href="https://medium.com/p/dbcd393f2780"><time class="dt-published" datetime="2025-12-23T08:45:06.307Z">December 23, 2025</time></a>.</p><p><a href="https://medium.com/@conan0s4/htb-labs-truesecrets-write-up-dbcd393f2780" class="p-canonical">Canonical link</a></p><p>Exported from <a href="https://medium.com">Medium</a> on February 7, 2026.</p></footer></article></body></html>