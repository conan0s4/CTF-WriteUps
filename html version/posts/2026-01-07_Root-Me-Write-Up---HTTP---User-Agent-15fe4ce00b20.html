<!DOCTYPE html><html><head><meta http-equiv="Content-Type" content="text/html; charset=utf-8"><title>Root-Me Write-Up : HTTP — User-Agent</title><style>
      * {
        font-family: Georgia, Cambria, "Times New Roman", Times, serif;
      }
      html, body {
        margin: 0;
        padding: 0;
      }
      h1 {
        font-size: 50px;
        margin-bottom: 17px;
        color: #333;
      }
      h2 {
        font-size: 24px;
        line-height: 1.6;
        margin: 30px 0 0 0;
        margin-bottom: 18px;
        margin-top: 33px;
        color: #333;
      }
      h3 {
        font-size: 30px;
        margin: 10px 0 20px 0;
        color: #333;
      }
      header {
        width: 640px;
        margin: auto;
      }
      section {
        width: 640px;
        margin: auto;
      }
      section p {
        margin-bottom: 27px;
        font-size: 20px;
        line-height: 1.6;
        color: #333;
      }
      section img {
        max-width: 640px;
      }
      footer {
        padding: 0 20px;
        margin: 50px 0;
        text-align: center;
        font-size: 12px;
      }
      .aspectRatioPlaceholder {
        max-width: auto !important;
        max-height: auto !important;
      }
      .aspectRatioPlaceholder-fill {
        padding-bottom: 0 !important;
      }
      header,
      section[data-field=subtitle],
      section[data-field=description] {
        display: none;
      }
      </style></head><body><article class="h-entry">
<header>
<h1 class="p-name">Root-Me Write-Up : HTTP — User-Agent</h1>
</header>
<section data-field="subtitle" class="p-summary">
Challenge Statement
</section>
<section data-field="body" class="e-content">
<section name="d407" class="section section--body section--first"><div class="section-divider"><hr class="section-divider"></div><div class="section-content"><div class="section-inner sectionLayout--insetColumn"><h3 name="b53d" id="b53d" class="graf graf--h3 graf--leading graf--title">Root-Me Write-Up : HTTP — User-Agent</h3><figure name="bcea" id="bcea" class="graf graf--figure graf-after--h3"><img class="graf-image" data-image-id="1*B_4RlhBBz5lw3zmQt_0Xlw.png" data-width="1106" data-height="304" data-is-featured="true" src="https://cdn-images-1.medium.com/max/800/1*B_4RlhBBz5lw3zmQt_0Xlw.png"></figure><h3 name="0934" id="0934" class="graf graf--h3 graf-after--figure">Challenge Statement</h3><p name="6fec" id="6fec" class="graf graf--p graf-after--h3 graf--trailing"><strong class="markup--strong markup--p-strong">Admin is really dumb…</strong></p></div></div></section><section name="601e" class="section section--body"><div class="section-divider"><hr class="section-divider"></div><div class="section-content"><div class="section-inner sectionLayout--insetColumn"><h3 name="512f" id="512f" class="graf graf--h3 graf--leading">Hint</h3><p name="4d55" id="4d55" class="graf graf--p graf-after--h3"><strong class="markup--strong markup--p-strong">User-Agent</strong></p><p name="480e" id="480e" class="graf graf--p graf-after--p graf--trailing">The HTTP <code class="markup--code markup--p-code">User-Agent</code> header identifies the client’s browser, operating system, and device to the web server. It is commonly used so the server can tailor responses, optimize content, or apply restrictions based on the client’s software or device.</p></div></div></section><section name="c273" class="section section--body"><div class="section-divider"><hr class="section-divider"></div><div class="section-content"><div class="section-inner sectionLayout--insetColumn"><h3 name="2512" id="2512" class="graf graf--h3 graf--leading">Objective</h3><p name="9075" id="9075" class="graf graf--p graf-after--h3 graf--trailing">Identify how the application uses the <code class="markup--code markup--p-code">User-Agent</code> header for access control and manipulate it to gain unauthorized access and retrieve the password.</p></div></div></section><section name="1298" class="section section--body"><div class="section-divider"><hr class="section-divider"></div><div class="section-content"><div class="section-inner sectionLayout--insetColumn"><h3 name="aec7" id="aec7" class="graf graf--h3 graf--leading">Analysis</h3><p name="ecd7" id="ecd7" class="graf graf--p graf-after--h3">Upon accessing the target link, the server returned the following message:</p><figure name="2ac1" id="2ac1" class="graf graf--figure graf-after--p"><img class="graf-image" data-image-id="1*J6xXNSCJk3AjxJmabSzWxQ.png" data-width="1365" data-height="557" src="https://cdn-images-1.medium.com/max/800/1*J6xXNSCJk3AjxJmabSzWxQ.png"></figure><blockquote name="387b" id="387b" class="graf graf--blockquote graf-after--figure"><strong class="markup--strong markup--blockquote-strong"><em class="markup--em markup--blockquote-em">Wrong user-agent: you are not the “admin” browser!</em></strong></blockquote><p name="a297" id="a297" class="graf graf--p graf-after--blockquote graf--trailing">This response indicates that the application performs access control checks based solely on the value of the <code class="markup--code markup--p-code">User-Agent</code> header. Since this header is fully controlled by the client, it presents a potential security weakness.</p></div></div></section><section name="ddbe" class="section section--body"><div class="section-divider"><hr class="section-divider"></div><div class="section-content"><div class="section-inner sectionLayout--insetColumn"><h3 name="47b0" id="47b0" class="graf graf--h3 graf--leading">Exploitation</h3><p name="44b9" id="44b9" class="graf graf--p graf-after--h3">The request was intercepted using <strong class="markup--strong markup--p-strong">Burp Suite</strong> and sent to the <strong class="markup--strong markup--p-strong">Repeater</strong> tool for modification.</p><h3 name="0070" id="0070" class="graf graf--h3 graf-after--p">Original User-Agent</h3><pre data-code-block-mode="1" spellcheck="false" data-code-block-lang="sql" name="930f" id="930f" class="graf graf--pre graf-after--h3 graf--preV2"><span class="pre--content"><span class="hljs-keyword">User</span><span class="hljs-operator">-</span>Agent: Mozilla<span class="hljs-operator">/</span><span class="hljs-number">5.0</span> (X11; Linux x86_64) AppleWebKit<span class="hljs-operator">/</span><span class="hljs-number">537.36</span> (KHTML, <span class="hljs-keyword">like</span> Gecko) Chrome<span class="hljs-operator">/</span><span class="hljs-number">133.0</span><span class="hljs-number">.0</span><span class="hljs-number">.0</span> Safari<span class="hljs-operator">/</span><span class="hljs-number">537.36</span></span></pre><figure name="cbc2" id="cbc2" class="graf graf--figure graf-after--pre"><img class="graf-image" data-image-id="1*1It4dLLPeE4HDo1FW8JuxA.png" data-width="1365" data-height="556" src="https://cdn-images-1.medium.com/max/800/1*1It4dLLPeE4HDo1FW8JuxA.png"></figure><p name="642c" id="642c" class="graf graf--p graf-after--figure">The <code class="markup--code markup--p-code">User-Agent</code> header was modified to impersonate the expected admin browser:</p><h3 name="40f5" id="40f5" class="graf graf--h3 graf-after--p">Modified User-Agent</h3><figure name="1d36" id="1d36" class="graf graf--figure graf-after--h3"><img class="graf-image" data-image-id="1*CjPvzTYiory4fmexpQsrfQ.png" data-width="1365" data-height="601" src="https://cdn-images-1.medium.com/max/800/1*CjPvzTYiory4fmexpQsrfQ.png"></figure><pre data-code-block-mode="1" spellcheck="false" data-code-block-lang="makefile" name="b660" id="b660" class="graf graf--pre graf-after--figure graf--preV2"><span class="pre--content"><span class="hljs-section">User-Agent: admin</span></span></pre><p name="da48" id="da48" class="graf graf--p graf-after--pre graf--trailing">The modified request was then sent to the server.</p></div></div></section><section name="7e9f" class="section section--body"><div class="section-divider"><hr class="section-divider"></div><div class="section-content"><div class="section-inner sectionLayout--insetColumn"><h3 name="7d86" id="7d86" class="graf graf--h3 graf--leading">Result</h3><p name="dd3b" id="dd3b" class="graf graf--p graf-after--h3">The server accepted the request and responded with:</p><blockquote name="b828" id="b828" class="graf graf--blockquote graf-after--p graf--trailing"><strong class="markup--strong markup--blockquote-strong"><em class="markup--em markup--blockquote-em">Welcome master! Password:</em></strong><em class="markup--em markup--blockquote-em"> </em><code class="markup--code markup--blockquote-code"><em class="markup--em markup--blockquote-em">rr$Li9%L34qd1AAe27</em></code></blockquote></div></div></section><section name="f1f4" class="section section--body section--last"><div class="section-divider"><hr class="section-divider"></div><div class="section-content"><div class="section-inner sectionLayout--insetColumn"><h3 name="8637" id="8637" class="graf graf--h3 graf--leading">Flag</h3><pre data-code-block-mode="1" spellcheck="false" data-code-block-lang="perl" name="5b31" id="5b31" class="graf graf--pre graf-after--h3 graf--trailing graf--preV2"><span class="pre--content">rr$Li9%L34qd1AAe27</span></pre></div></div></section>
</section>
<footer><p>By <a href="https://medium.com/@conan0s4" class="p-author h-card">Alexander Sapo</a> on <a href="https://medium.com/p/15fe4ce00b20"><time class="dt-published" datetime="2026-01-07T05:48:02.438Z">January 7, 2026</time></a>.</p><p><a href="https://medium.com/@conan0s4/root-me-write-up-http-user-agent-15fe4ce00b20" class="p-canonical">Canonical link</a></p><p>Exported from <a href="https://medium.com">Medium</a> on February 7, 2026.</p></footer></article></body></html>