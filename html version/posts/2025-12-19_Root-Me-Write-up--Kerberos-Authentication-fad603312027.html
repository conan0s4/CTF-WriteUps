<!DOCTYPE html><html><head><meta http-equiv="Content-Type" content="text/html; charset=utf-8"><title>Root-Me Write-up: Kerberos Authentication</title><style>
      * {
        font-family: Georgia, Cambria, "Times New Roman", Times, serif;
      }
      html, body {
        margin: 0;
        padding: 0;
      }
      h1 {
        font-size: 50px;
        margin-bottom: 17px;
        color: #333;
      }
      h2 {
        font-size: 24px;
        line-height: 1.6;
        margin: 30px 0 0 0;
        margin-bottom: 18px;
        margin-top: 33px;
        color: #333;
      }
      h3 {
        font-size: 30px;
        margin: 10px 0 20px 0;
        color: #333;
      }
      header {
        width: 640px;
        margin: auto;
      }
      section {
        width: 640px;
        margin: auto;
      }
      section p {
        margin-bottom: 27px;
        font-size: 20px;
        line-height: 1.6;
        color: #333;
      }
      section img {
        max-width: 640px;
      }
      footer {
        padding: 0 20px;
        margin: 50px 0;
        text-align: center;
        font-size: 12px;
      }
      .aspectRatioPlaceholder {
        max-width: auto !important;
        max-height: auto !important;
      }
      .aspectRatioPlaceholder-fill {
        padding-bottom: 0 !important;
      }
      header,
      section[data-field=subtitle],
      section[data-field=description] {
        display: none;
      }
      </style></head><body><article class="h-entry">
<header>
<h1 class="p-name">Root-Me Write-up: Kerberos Authentication</h1>
</header>
<section data-field="subtitle" class="p-summary">
Challenge Hint
</section>
<section data-field="body" class="e-content">
<section name="7db0" class="section section--body section--first"><div class="section-divider"><hr class="section-divider"></div><div class="section-content"><div class="section-inner sectionLayout--insetColumn"><h3 name="1871" id="1871" class="graf graf--h3 graf--leading graf--title">Root-Me Write-up: Kerberos Authentication</h3><figure name="f8d3" id="f8d3" class="graf graf--figure graf-after--h3"><img class="graf-image" data-image-id="1*8ZGb8yztmRQkOdXUlFBLfw.png" data-width="812" data-height="412" data-is-featured="true" src="https://cdn-images-1.medium.com/max/800/1*8ZGb8yztmRQkOdXUlFBLfw.png"></figure><h3 name="a938" id="a938" class="graf graf--h3 graf-after--figure">Challenge Hint</h3><p name="ed29" id="ed29" class="graf graf--p graf-after--h3 graf--trailing"><strong class="markup--strong markup--p-strong">Kerberos — Authentication</strong><br>Retrieve a user’s password linked to a suspicious Kerberos connection.</p></div></div></section><section name="5e40" class="section section--body"><div class="section-divider"><hr class="section-divider"></div><div class="section-content"><div class="section-inner sectionLayout--insetColumn"><h3 name="c00f" id="c00f" class="graf graf--h3 graf--leading">Background</h3><p name="50b5" id="50b5" class="graf graf--p graf-after--h3">Kerberos does <strong class="markup--strong markup--p-strong">not</strong> transmit passwords in plaintext. Instead, authentication relies on <strong class="markup--strong markup--p-strong">encrypted tickets</strong> derived from the user’s password.</p><p name="a931" id="a931" class="graf graf--p graf-after--p">Based on research, the technique applicable here is <strong class="markup--strong markup--p-strong">AS-REP Roasting</strong>, which allows an attacker to recover a user’s password <strong class="markup--strong markup--p-strong">offline</strong> if certain conditions are met.</p><p name="8ab2" id="8ab2" class="graf graf--p graf-after--p">In this scenario, the goal is to:</p><ul class="postList"><li name="ba88" id="ba88" class="graf graf--li graf-after--p">Identify a successful Kerberos authentication</li><li name="05f5" id="05f5" class="graf graf--li graf-after--li">Extract the required fields from the Kerberos traffic</li><li name="7dec" id="7dec" class="graf graf--li graf-after--li">Convert them into a <strong class="markup--strong markup--li-strong">Hashcat-compatible format</strong></li><li name="1aca" id="1aca" class="graf graf--li graf-after--li graf--trailing">Brute-force the password offline</li></ul></div></div></section><section name="25f6" class="section section--body"><div class="section-divider"><hr class="section-divider"></div><div class="section-content"><div class="section-inner sectionLayout--insetColumn"><h3 name="1082" id="1082" class="graf graf--h3 graf--leading">Kerberos Authentication Flow Observed</h3><p name="541d" id="541d" class="graf graf--p graf-after--h3">Kerberos packets were filtered and analyzed using <strong class="markup--strong markup--p-strong">Wireshark</strong>. The following sequence was observed:</p><figure name="54cd" id="54cd" class="graf graf--figure graf-after--p"><img class="graf-image" data-image-id="1*zMhSFTF6TBk3Z4C_e2XPJQ.png" data-width="1366" data-height="654" src="https://cdn-images-1.medium.com/max/800/1*zMhSFTF6TBk3Z4C_e2XPJQ.png"></figure><pre data-code-block-mode="1" spellcheck="false" data-code-block-lang="markdown" name="4637" id="4637" class="graf graf--pre graf-after--figure graf--preV2"><span class="pre--content">[1] Client → KDC : AS-REQ<br /><span class="hljs-bullet">    -</span> Initial authentication attempt<br /><span class="hljs-bullet">    -</span> Missing pre-authentication data</span></pre><pre name="2d65" id="2d65" class="graf graf--pre graf-after--pre">[2] KDC → Client : AS-REQ ERROR (Pre-auth required)<br>    - Username exists<br>    - Kerberos service reachable</pre><pre name="6714" id="6714" class="graf graf--pre graf-after--pre">[3] Client → KDC : AS-REQ (with pre-auth)<br>    - Password-derived data included</pre><pre name="8b9b" id="8b9b" class="graf graf--pre graf-after--pre">[4] KDC → Client : AS-REP<br>    - Authentication successful<br>    - Ticket Granting Ticket (TGT) issued</pre><pre name="7a51" id="7a51" class="graf graf--pre graf-after--pre">[5] Client → KDC : TGS-REQ<br>    - Requests service ticket (SMB)</pre><pre name="0769" id="0769" class="graf graf--pre graf-after--pre">[6] KDC → Client : TGS-REP<br>    - Service ticket issued</pre><p name="3d61" id="3d61" class="graf graf--p graf-after--pre graf--trailing">The <strong class="markup--strong markup--p-strong">successful authentication</strong> occurs at step <strong class="markup--strong markup--p-strong">[4] (AS-REP)</strong>. This response contains the encrypted material required for offline cracking.</p></div></div></section><section name="d238" class="section section--body"><div class="section-divider"><hr class="section-divider"></div><div class="section-content"><div class="section-inner sectionLayout--insetColumn"><h3 name="772a" id="772a" class="graf graf--h3 graf--leading">Extracting Key Fields</h3><p name="7877" id="7877" class="graf graf--p graf-after--h3">The required values were extracted from the <strong class="markup--strong markup--p-strong">AS-REQ with pre-authentication</strong> packet.</p><figure name="9651" id="9651" class="graf graf--figure graf-after--p"><img class="graf-image" data-image-id="1*2jbZVDja3n3O7Um17fjzow.png" data-width="1230" data-height="495" src="https://cdn-images-1.medium.com/max/800/1*2jbZVDja3n3O7Um17fjzow.png"></figure><figure name="c2ae" id="c2ae" class="graf graf--figure graf-after--figure"><img class="graf-image" data-image-id="1*k0AAMmrk04-tjDJc5M9hzA.png" data-width="1058" data-height="534" src="https://cdn-images-1.medium.com/max/800/1*k0AAMmrk04-tjDJc5M9hzA.png"></figure><h3 name="f084" id="f084" class="graf graf--h3 graf-after--figure">Relevant Packet Fields</h3><pre data-code-block-mode="1" spellcheck="false" data-code-block-lang="objectivec" name="1c72" id="1c72" class="graf graf--pre graf-after--h3 graf--trailing graf--preV2"><span class="pre--content">Encryption Type (etype): AES256-<span class="hljs-built_in">CTS</span>-HMAC-SHA1<span class="hljs-number">-96</span> (<span class="hljs-number">18</span>)<br />Realm: <span class="hljs-built_in">CATCORP</span>.LOCAL<br /><span class="hljs-built_in">CNameString</span> (username): william.dupond<br />Ciphertext:<br />fc8bbe22b2c967b222ed73dd7616ea71b2ae0c1b0c3688bfff7fecffdebd4054<br /><span class="hljs-number">471350</span>cb6e36d3b55ba3420be6c0210b2d978d3f51d1eb4f</span></pre></div></div></section><section name="3e88" class="section section--body"><div class="section-divider"><hr class="section-divider"></div><div class="section-content"><div class="section-inner sectionLayout--insetColumn"><h3 name="bd6c" id="bd6c" class="graf graf--h3 graf--leading">Building the Hashcat Format</h3><p name="9957" id="9957" class="graf graf--p graf-after--h3">Hashcat requires the following AS-REP format:</p><pre data-code-block-mode="1" spellcheck="false" data-code-block-lang="ruby" name="60b5" id="60b5" class="graf graf--pre graf-after--p graf--preV2"><span class="pre--content"><span class="hljs-variable">$krb</span>5pa<span class="hljs-variable">$&lt;</span>etype&gt;<span class="hljs-variable">$&lt;</span>username&gt;<span class="hljs-variable">$&lt;</span>realm&gt;<span class="hljs-variable">$&lt;</span>ciphertext&gt;</span></pre><h3 name="3ccd" id="3ccd" class="graf graf--h3 graf-after--pre">Constructed Hash</h3><pre data-code-block-mode="1" spellcheck="false" data-code-block-lang="perl" name="bc03" id="bc03" class="graf graf--pre graf-after--h3 graf--preV2"><span class="pre--content">$krb5pa$18$william.dupond$CATCORP.LOCAL$fc8bbe22b2c967b222ed73dd7616ea71b2ae0c1b0c3688bfff7fecffdebd4054471350cb6e36d3b55ba3420be6c0210b2d978d3f51d1eb4f</span></pre><p name="abed" id="abed" class="graf graf--p graf-after--pre graf--trailing">This hash was saved to a file for offline cracking.</p></div></div></section><section name="7b71" class="section section--body"><div class="section-divider"><hr class="section-divider"></div><div class="section-content"><div class="section-inner sectionLayout--insetColumn"><h3 name="eb81" id="eb81" class="graf graf--h3 graf--leading">Cracking the Password</h3><p name="a49c" id="a49c" class="graf graf--p graf-after--h3">Since the encryption type is <strong class="markup--strong markup--p-strong">etype 18 (AES256)</strong>, the correct Hashcat mode is <strong class="markup--strong markup--p-strong">19900</strong>.</p><figure name="0d2b" id="0d2b" class="graf graf--figure graf-after--p"><img class="graf-image" data-image-id="1*efv_RmqzNjJgJc1Akqcblw.png" data-width="676" data-height="210" src="https://cdn-images-1.medium.com/max/800/1*efv_RmqzNjJgJc1Akqcblw.png"></figure><h3 name="bcf8" id="bcf8" class="graf graf--h3 graf-after--figure">Hashcat Command</h3><pre data-code-block-mode="1" spellcheck="false" data-code-block-lang="typescript" name="98ca" id="98ca" class="graf graf--pre graf-after--h3 graf--preV2"><span class="pre--content">hashcat -m <span class="hljs-number">19900</span> krb_hash.<span class="hljs-property">txt</span> rockyou.<span class="hljs-property">txt</span></span></pre><p name="9af7" id="9af7" class="graf graf--p graf-after--pre">The brute-force attack successfully recovered the user’s password.</p><figure name="11f7" id="11f7" class="graf graf--figure graf-after--p graf--trailing"><img class="graf-image" data-image-id="1*NT9K067tz_43taUvkl67ag.png" data-width="964" data-height="545" src="https://cdn-images-1.medium.com/max/800/1*NT9K067tz_43taUvkl67ag.png"></figure></div></div></section><section name="c065" class="section section--body"><div class="section-divider"><hr class="section-divider"></div><div class="section-content"><div class="section-inner sectionLayout--insetColumn"><h3 name="18a5" id="18a5" class="graf graf--h3 graf--leading">Flag Construction</h3><p name="57cb" id="57cb" class="graf graf--p graf-after--h3">The flag format was specified as:</p><pre data-code-block-mode="1" spellcheck="false" data-code-block-lang="css" name="b2dd" id="b2dd" class="graf graf--pre graf-after--p graf--preV2"><span class="pre--content">RM{userPrincipalName:password}</span></pre><h3 name="58f7" id="58f7" class="graf graf--h3 graf-after--pre">Determining the User Principal Name (UPN)</h3><ul class="postList"><li name="7364" id="7364" class="graf graf--li graf-after--h3">Username: <code class="markup--code markup--li-code">william.dupond</code></li><li name="895d" id="895d" class="graf graf--li graf-after--li">Realm: <code class="markup--code markup--li-code">CATCORP.LOCAL</code></li></ul><p name="b791" id="b791" class="graf graf--p graf-after--li">Initial attempt:</p><pre data-code-block-mode="1" spellcheck="false" data-code-block-lang="sql" name="3a6c" id="3a6c" class="graf graf--pre graf-after--p graf--preV2"><span class="pre--content">william.dupond<span class="hljs-variable">@catcorp</span>.<span class="hljs-keyword">local</span></span></pre><p name="301d" id="301d" class="graf graf--p graf-after--pre">Password recovered:</p><pre data-code-block-mode="1" spellcheck="false" data-code-block-lang="typescript" name="b6da" id="b6da" class="graf graf--pre graf-after--p graf--preV2"><span class="pre--content">kittycat12</span></pre><p name="e8a6" id="e8a6" class="graf graf--p graf-after--pre">The correct domain used in the flag was <strong class="markup--strong markup--p-strong">catcorp.com</strong>, resulting in:</p><pre data-code-block-mode="1" spellcheck="false" data-code-block-lang="scss" name="2d54" id="2d54" class="graf graf--pre graf-after--p graf--trailing graf--preV2"><span class="pre--content">RM{william<span class="hljs-selector-class">.dupond</span><span class="hljs-keyword">@catcorp</span>.<span class="hljs-attribute">com</span>:kittycat12}</span></pre></div></div></section><section name="8a19" class="section section--body"><div class="section-divider"><hr class="section-divider"></div><div class="section-content"><div class="section-inner sectionLayout--insetColumn"><h3 name="f8b6" id="f8b6" class="graf graf--h3 graf--leading">Final Flag</h3><pre data-code-block-mode="1" spellcheck="false" data-code-block-lang="scss" name="9bba" id="9bba" class="graf graf--pre graf-after--h3 graf--trailing graf--preV2"><span class="pre--content">RM{william<span class="hljs-selector-class">.dupond</span><span class="hljs-keyword">@catcorp</span>.<span class="hljs-attribute">com</span>:kittycat12}</span></pre></div></div></section><section name="3ac3" class="section section--body section--last"><div class="section-divider"><hr class="section-divider"></div><div class="section-content"><div class="section-inner sectionLayout--insetColumn"><h3 name="a893" id="a893" class="graf graf--h3 graf--leading">References</h3><ul class="postList"><li name="2017" id="2017" class="graf graf--li graf-after--h3"><a href="https://www.fortinet.com/resources/cyberglossary/kerberos-authentication" data-href="https://www.fortinet.com/resources/cyberglossary/kerberos-authentication" class="markup--anchor markup--li-anchor" rel="noopener" target="_blank">https://www.fortinet.com/resources/cyberglossary/kerberos-authentication</a></li><li name="bc17" id="bc17" class="graf graf--li graf-after--li"><a href="https://www.varonis.com/blog/kerberos-authentication-explained" data-href="https://www.varonis.com/blog/kerberos-authentication-explained" class="markup--anchor markup--li-anchor" rel="noopener" target="_blank">https://www.varonis.com/blog/kerberos-authentication-explained</a></li><li name="2fb1" id="2fb1" class="graf graf--li graf-after--li"><a href="https://beta.hackndo.com/kerberos/" data-href="https://beta.hackndo.com/kerberos/" class="markup--anchor markup--li-anchor" rel="noopener" target="_blank">https://beta.hackndo.com/kerberos/</a></li><li name="279a" id="279a" class="graf graf--li graf-after--li graf--trailing"><a href="https://owasp.org/www-chapter-bangkok/slides/2025/2025-02-07_Breaking-the-Ticket-A-Beginners-Guide-to-Kerberos-Attacks.pdf" data-href="https://owasp.org/www-chapter-bangkok/slides/2025/2025-02-07_Breaking-the-Ticket-A-Beginners-Guide-to-Kerberos-Attacks.pdf" class="markup--anchor markup--li-anchor" rel="noopener" target="_blank">https://owasp.org/www-chapter-bangkok/slides/2025/2025-02-07_Breaking-the-Ticket-A-Beginners-Guide-to-Kerberos-Attacks.pdf</a></li></ul></div></div></section>
</section>
<footer><p>By <a href="https://medium.com/@conan0s4" class="p-author h-card">Alexander Sapo</a> on <a href="https://medium.com/p/fad603312027"><time class="dt-published" datetime="2025-12-19T02:03:22.836Z">December 19, 2025</time></a>.</p><p><a href="https://medium.com/@conan0s4/root-me-write-up-kerberos-authentication-fad603312027" class="p-canonical">Canonical link</a></p><p>Exported from <a href="https://medium.com">Medium</a> on February 7, 2026.</p></footer></article></body></html>