<!DOCTYPE html><html><head><meta http-equiv="Content-Type" content="text/html; charset=utf-8"><title>Root-Me Write-up: Directory Traversal</title><style>
      * {
        font-family: Georgia, Cambria, "Times New Roman", Times, serif;
      }
      html, body {
        margin: 0;
        padding: 0;
      }
      h1 {
        font-size: 50px;
        margin-bottom: 17px;
        color: #333;
      }
      h2 {
        font-size: 24px;
        line-height: 1.6;
        margin: 30px 0 0 0;
        margin-bottom: 18px;
        margin-top: 33px;
        color: #333;
      }
      h3 {
        font-size: 30px;
        margin: 10px 0 20px 0;
        color: #333;
      }
      header {
        width: 640px;
        margin: auto;
      }
      section {
        width: 640px;
        margin: auto;
      }
      section p {
        margin-bottom: 27px;
        font-size: 20px;
        line-height: 1.6;
        color: #333;
      }
      section img {
        max-width: 640px;
      }
      footer {
        padding: 0 20px;
        margin: 50px 0;
        text-align: center;
        font-size: 12px;
      }
      .aspectRatioPlaceholder {
        max-width: auto !important;
        max-height: auto !important;
      }
      .aspectRatioPlaceholder-fill {
        padding-bottom: 0 !important;
      }
      header,
      section[data-field=subtitle],
      section[data-field=description] {
        display: none;
      }
      </style></head><body><article class="h-entry">
<header>
<h1 class="p-name">Root-Me Write-up: Directory Traversal</h1>
</header>
<section data-field="subtitle" class="p-summary">
Initial Assessment
</section>
<section data-field="body" class="e-content">
<section name="f620" class="section section--body section--first section--last"><div class="section-divider"><hr class="section-divider"></div><div class="section-content"><div class="section-inner sectionLayout--insetColumn"><h3 name="c099" id="c099" class="graf graf--h3 graf--leading graf--title">Root-Me Write-up: Directory Traversal</h3><figure name="fb96" id="fb96" class="graf graf--figure graf-after--h3"><img class="graf-image" data-image-id="1*2YWJ_awxS8L0OxjRdA9BJg.png" data-width="1095" data-height="320" data-is-featured="true" src="https://cdn-images-1.medium.com/max/800/1*2YWJ_awxS8L0OxjRdA9BJg.png"></figure><h3 name="5632" id="5632" class="graf graf--h3 graf-after--figure">Initial Assessment</h3><p name="73aa" id="73aa" class="graf graf--p graf-after--h3">The challenge appeared to involve a <strong class="markup--strong markup--p-strong">path traversal vulnerability</strong>, which occurs when user-controlled input is not properly sanitized, allowing an attacker to access files or directories outside the intended scope by manipulating path parameters (e.g., <code class="markup--code markup--p-code">../</code>).</p><p name="49fa" id="49fa" class="graf graf--p graf-after--p">I began with basic test cases such as <code class="markup--code markup--p-code">../</code> and other typical traversal payloads to observe how the application handled directory navigation.</p><h3 name="e63c" id="e63c" class="graf graf--h3 graf-after--p">Enumeration</h3><p name="1371" id="1371" class="graf graf--p graf-after--h3">Next, I attempted directory enumeration using <strong class="markup--strong markup--p-strong">Gobuster</strong>, targeting commonly known directories. While this provided general context, the more useful insight came from manually inspecting the application.</p><p name="2616" id="2616" class="graf graf--p graf-after--p">Upon interacting with the gallery feature, I noticed that selecting different categories triggered requests of the following format:</p><pre data-code-block-mode="1" spellcheck="false" data-code-block-lang="bash" name="c209" id="c209" class="graf graf--pre graf-after--p graf--preV2"><span class="pre--content">/ch15.php?galerie=&lt;category&gt;</span></pre><figure name="5c32" id="5c32" class="graf graf--figure graf-after--pre"><img class="graf-image" data-image-id="1*NIXR1JG29wssDRDRk1joQQ.png" data-width="1365" data-height="598" src="https://cdn-images-1.medium.com/max/800/1*NIXR1JG29wssDRDRk1joQQ.png"></figure><p name="cb6b" id="cb6b" class="graf graf--p graf-after--figure">Based on the challenge hints, it was suggested that something important was hidden within the <code class="markup--code markup--p-code">galerie</code> parameter.</p><h3 name="bee4" id="bee4" class="graf graf--h3 graf-after--p">Exploitation</h3><p name="d30e" id="d30e" class="graf graf--p graf-after--h3">I tested the following payload:</p><pre data-code-block-mode="1" spellcheck="false" data-code-block-lang="bash" name="5fbd" id="5fbd" class="graf graf--pre graf-after--p graf--preV2"><span class="pre--content">/ch15.php?galerie=/</span></pre><p name="b84e" id="b84e" class="graf graf--p graf-after--pre">This effectively forced the application to reference another directory. As a result, a uniquely named image file was revealed:</p><pre data-code-block-mode="1" spellcheck="false" data-code-block-lang="typescript" name="8075" id="8075" class="graf graf--pre graf-after--p graf--preV2"><span class="pre--content">86hwnX2r</span></pre><p name="61d5" id="61d5" class="graf graf--p graf-after--pre">The HTML source showed the following element:</p><pre data-code-block-mode="1" spellcheck="false" data-code-block-lang="xml" name="96bd" id="96bd" class="graf graf--pre graf-after--p graf--preV2"><span class="pre--content"><span class="hljs-tag">&lt;<span class="hljs-name">img</span> <span class="hljs-attr">width</span>=<span class="hljs-string">&quot;64px&quot;</span> <span class="hljs-attr">height</span>=<span class="hljs-string">&quot;64px&quot;</span> <span class="hljs-attr">src</span>=<span class="hljs-string">&quot;galerie///86hwnX2r&quot;</span> <span class="hljs-attr">alt</span>=<span class="hljs-string">&quot;86hwnX2r&quot;</span>&gt;</span></span></pre><p name="bcb6" id="bcb6" class="graf graf--p graf-after--pre">Using the browser’s inspector, I examined the full path and then attempted to access it directly:</p><figure name="6c13" id="6c13" class="graf graf--figure graf-after--p"><img class="graf-image" data-image-id="1*hDkF-5NDmN4IPLlfaw9Kbw.png" data-width="1365" data-height="647" src="https://cdn-images-1.medium.com/max/800/1*hDkF-5NDmN4IPLlfaw9Kbw.png"></figure><pre data-code-block-mode="1" spellcheck="false" data-code-block-lang="bash" name="51f1" id="51f1" class="graf graf--pre graf-after--figure graf--preV2"><span class="pre--content">/ch15.php?galerie=86hwnX2r</span></pre><p name="3bf6" id="3bf6" class="graf graf--p graf-after--pre">This led to another discovery. The page referenced a text file:</p><pre data-code-block-mode="1" spellcheck="false" data-code-block-lang="xml" name="c524" id="c524" class="graf graf--pre graf-after--p graf--preV2"><span class="pre--content"><span class="hljs-tag">&lt;<span class="hljs-name">img</span> <span class="hljs-attr">width</span>=<span class="hljs-string">&quot;64px&quot;</span> <span class="hljs-attr">height</span>=<span class="hljs-string">&quot;64px&quot;</span> <span class="hljs-attr">src</span>=<span class="hljs-string">&quot;galerie/86hwnX2r/password.txt&quot;</span> <span class="hljs-attr">alt</span>=<span class="hljs-string">&quot;password.txt&quot;</span>&gt;</span></span></pre><figure name="49de" id="49de" class="graf graf--figure graf-after--pre"><img class="graf-image" data-image-id="1*sS4gmKHDZCHaO55L1XhjSg.png" data-width="1365" data-height="687" src="https://cdn-images-1.medium.com/max/800/1*sS4gmKHDZCHaO55L1XhjSg.png"></figure><h3 name="92cd" id="92cd" class="graf graf--h3 graf-after--figure">Flag Retrieval</h3><p name="0a83" id="0a83" class="graf graf--p graf-after--h3">From the <code class="markup--code markup--p-code">src</code> attribute, the full file path could be inferred. I accessed it directly via:</p><pre data-code-block-mode="1" spellcheck="false" data-code-block-lang="bash" name="1541" id="1541" class="graf graf--pre graf-after--p graf--preV2"><span class="pre--content">/ch5/galerie/86hwnX2r/password.txt</span></pre><p name="0ee6" id="0ee6" class="graf graf--p graf-after--pre">This successfully revealed the flag.</p><figure name="a696" id="a696" class="graf graf--figure graf-after--p"><img class="graf-image" data-image-id="1*W4Em-TJygRtaBPQQme7nuA.png" data-width="1365" data-height="566" src="https://cdn-images-1.medium.com/max/800/1*W4Em-TJygRtaBPQQme7nuA.png"></figure><h3 name="c610" id="c610" class="graf graf--h3 graf-after--figure">Flag</h3><pre data-code-block-mode="1" spellcheck="false" data-code-block-lang="ruby" name="7c24" id="7c24" class="graf graf--pre graf-after--h3 graf--trailing graf--preV2"><span class="pre--content">kcb<span class="hljs-variable">$!</span><span class="hljs-title class_">Bx</span><span class="hljs-variable">@v4Gs</span>9Ez</span></pre></div></div></section>
</section>
<footer><p>By <a href="https://medium.com/@conan0s4" class="p-author h-card">Alexander Sapo</a> on <a href="https://medium.com/p/cfc826ff19fe"><time class="dt-published" datetime="2025-12-30T11:24:44.220Z">December 30, 2025</time></a>.</p><p><a href="https://medium.com/@conan0s4/root-me-write-up-directory-traversal-cfc826ff19fe" class="p-canonical">Canonical link</a></p><p>Exported from <a href="https://medium.com">Medium</a> on February 7, 2026.</p></footer></article></body></html>